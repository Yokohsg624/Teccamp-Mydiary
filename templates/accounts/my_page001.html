{% extends 'diary/base.html' %}
{% load static %}


{% block content %}
<h2>ãƒã‚¤ãƒšãƒ¼ã‚¸</h2>
<!--ãƒã‚¤ãƒšãƒ¼ã‚¸è¡¨ç¤º-->
<p>ãƒ¦ãƒ¼ã‚¶ãƒ¼å: {{ user.username }}</p>
<p>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹: {{ user.email }}</p>
<p>ç™»éŒ²æ—¥: {{ user.date_joined }}</p>
<p>æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³: {{ user.last_login }}</p>
<p>ã‚³ãƒ¡ãƒ³ãƒˆæ•°: {{ diary_count }}</p>

{% if profile_image_url %}
<h3>ç¾åœ¨ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ</h3>
<img src="{{ profile_image_url }}" alt="ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ" style="width: 200px; height: auto; border-radius: 8px;">
{% else %}
<p>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã¯ã¾ã è¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
{% endif %}

<form method="POST" enctype="multipart/form-data" action="{% url 'accounts:mypage' %}" class="form_normal_style">
    {% csrf_token %}
    <!-- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¬„ -->
    <h3>ğŸ“¸ å†™çœŸã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã‚ˆã†ï¼</h3>
    <hr class="cp_hr02" />
    <input type="file" name="profile_image" id="imageInput">
    <!-- ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
    <div>
        <img id="imagePreview" src="#" alt="ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼" class="preview-image">
    </div>
    <br>

    <!-- é€ä¿¡ãƒœã‚¿ãƒ³ -->
    <div>
        <input type="submit" value="é€ä¿¡" class="mood-btn"
            style="background-color: #007bff; color: white; border: none; padding: 0.7em 1.5em; border-radius: 4px; cursor: pointer;">
    </div>
</form>

<script>
    const imageInput = document.getElementById('imageInput');
    const imagePreview = document.getElementById('imagePreview');
    const noImageSrc = "./static/img/noimage.jpg";

    imageInput.addEventListener('change', function () {
        const file = this.files[0];
        console.log(file); // é¸æŠã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®æƒ…å ±ã‚’è¡¨ç¤º

        if (file) {
            const reader = new FileReader();

            reader.addEventListener('load', function () {
                console.log("ç”»åƒã®srcã«è¨­å®šã™ã‚‹ãƒ‡ãƒ¼ã‚¿:", reader.result); // è¨­å®šã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª
                imagePreview.src = reader.result;
                imagePreview.style.display = 'block';
            });

            reader.readAsDataURL(file);
        } else {
            // ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ãªã„å ´åˆã€noimage.png ã‚’è¡¨ç¤º
            imagePreview.src = noImageSrc;
        }
    });

    //imagePreview.style.display = 'block';

    console.log(imageInput);
    console.log(imagePreview);
</script>
</form>
{% endblock %}